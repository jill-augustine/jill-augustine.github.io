{% if site.google_analytics %}
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src='https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}'></script>
  <script>   
    var gaProperty = '{{ site.google_analytics }}';
    var disableStr = 'ga-disable-' + gaProperty;

    window.addEventListener("load", function() {
      // load pop-up if no disableStr cookie exists
      if (!document.cookie.split(';')
                        .map(item => item.trim().split('=')[0])
                        .includes(disableStr)) {
                          // show popup box
                          let banner = document.getElementById('cookie_banner');
                          banner.style.display = "block";

      }});
    // Opt-out function
    function gaOptout() {
      document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
      window[disableStr] = true;
      let banner = document.getElementById('cookie_banner');
      banner.style.display = "none";
    }
    // Opt-in function
    function gaOptin() {
      document.cookie = disableStr + '=false; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
      window[disableStr] = false; // this is the default
      let banner = document.getElementById('cookie_banner');
      banner.style.display = "none";
    }  
  </script>
  <script>
    if (document.cookie.indexOf(disableStr + '=true') > -1) {
      window[disableStr] = true;
    }
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ site.google_analytics }}');
  </script>
{% endif %}